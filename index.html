<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weihnachtskarte</title>

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>

    <!-- AR.js fÃ¼r A-Frame -->
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>

</head>

<body style='margin: 0; overflow: hidden;'>

    <a-scene embedded arjs>

        <!-- Schneefall-Container -->
        <a-entity id="snow"></a-entity>

        <!-- Dein Schneemann -->
        <a-image src="snowman.png" position="0 0 0"></a-image>

        <!-- Marker Kamera -->
        <a-marker-camera type="pattern" url="pattern-Piktogramm MArker.patt"></a-marker-camera>

    </a-scene>

    <script>
        const targetObject = document.querySelector('#snow');

        for (let i = 0; i < 100; i++) {
            const plane = document.createElement('a-plane');
            const size = (Math.random() * .3 + 0.03).toFixed(2);

            const startX = (Math.random() - 0.5) * 8;
            const startY = Math.random() * 6 + 2;
            const startZ = (Math.random() - 0.5) * 8;

            const endY = -10;

            plane.setAttribute('width', size);
            plane.setAttribute('height', size);
            plane.setAttribute('position', `${startX} ${startY} ${startZ}`);
            plane.setAttribute('material', {
                src: 'assets/snowflake.png',
                alphaTest: 0.5,
                transparent: true
            });

            const duration = 4000 + Math.random() * 3000;

            plane.setAttribute('animation__fall', {
                property: 'position',
                from: `${startX} ${startY} ${startZ}`,
                to: `${startX} ${endY} ${startZ}`,
                dur: duration,
                easing: 'linear',
                loop: true
            });

            plane.addEventListener('animationloop', () => {
                const newX = (Math.random() - 0.5) * 8;
                const newY = Math.random() * 6 + 2;
                const newZ = (Math.random() - 0.5) * 8;

                plane.setAttribute('animation__fall', {
                    from: `${newX} ${newY} ${newZ}`,
                    to: `${newX} ${endY} ${newZ}`,
                    dur: 4000 + Math.random() * 3000
                });
            });

            targetObject.appendChild(plane);
        }
    </script>

</body>
</html>